<!doctype html>

<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>孤岛生存 - 简易版</title>
  <style>
    :root{--bg:#f7f7f7;--panel:#fff;--accent:#6bb07a}
    body{font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#222}
    .top{background:var(--panel);padding:10px 14px;border-bottom:1px solid #e6e6e6;display:flex;align-items:center;gap:18px}
    .stats{display:flex;gap:10px;align-items:center}
    .stat{font-size:13px}
    .container{max-width:960px;margin:18px auto;padding:14px}
    .map{display:grid;grid-template-columns:repeat(11,36px);grid-auto-rows:36px;gap:2px;background:#ddd;padding:6px;border-radius:6px}
    .cell{width:36px;height:36px;display:flex;align-items:center;justify-content:center;font-size:11px;border-radius:4px;background:#fff;box-shadow:0 0 0 1px rgba(0,0,0,0.02) inset}
    .cell.grass{background:#d9f0d9}
    .cell.desert{background:#fff0c2}
    .cell.mountain{background:#f0e6d9;color:#8b5}
    .cell.wall{background:#e6e6e6}
    .cell.water{background:#dff0ff}
    .cell.player{background:#55a; color:#fff}
    .controls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
    button{padding:8px 10px;border-radius:6px;border:1px solid #ccc;background:#fff;cursor:pointer}
    button.primary{background:var(--accent);color:#fff;border-color:transparent}
    .log{margin-top:12px;background:#fff;padding:10px;border-radius:6px;min-height:80px;max-height:180px;overflow:auto;font-size:13px}
    .resources{display:flex;gap:8px;margin-top:12px}
    .resource{background:#fff;padding:6px 8px;border-radius:6px;border:1px solid #eee}
    @media (max-width:520px){.map{grid-template-columns:repeat(11,28px);grid-auto-rows:28px}.cell{width:28px;height:28px;font-size:10px}}
  </style>
</head>
<body>
  <div class="top">
    <div style="font-weight:700">孤岛生存（简易）</div>
    <div class="stats">
      <div class="stat">LV: <span id="lv">1</span></div>
      <div class="stat">HP: <span id="hp">100</span>/100</div>
      <div class="stat">饥饿: <span id="hung">100</span>/100</div>
      <div class="stat">水分: <span id="water">100</span>/100</div>
      <div class="stat">负重: <span id="load">0</span>/20</div>
    </div>
  </div>  <div class="container">
    <div style="display:flex;gap:18px;align-items:flex-start">
      <div>
        <div class="map" id="map"></div>
        <div class="controls">
          <button id="up">↑</button>
          <button id="left">←</button>
          <button id="down">↓</button>
          <button id="right">→</button>
          <button id="explore">探索</button>
          <button id="gather">采集</button>
          <button id="save">保存</button>
          <button id="load">读取</button>
        </div>
      </div>
      <div style="flex:1;min-width:220px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:600">信息面板</div>
          <div style="font-size:12px;color:#666">使用方向键或按钮移动</div>
        </div>
        <div class="resources" id="resources"></div>
        <div class="log" id="log"></div>
      </div>
    </div>
  </div><script>
  // 简易游戏数据
  const SIZE = 11;
  const mapEl = document.getElementById('map');
  const logEl = document.getElementById('log');
  const resourcesEl = document.getElementById('resources');

  const types = ['forest','plains','desert','taiga','swamp','snow','mountain','beach','ocean'];

  let state = {
    player:{x:Math.floor(SIZE/2),y:Math.floor(SIZE/2)},
    hp:100,hunger:100,water:100,lv:1,load:0,inventory:{'草':3},
    tiles:[],time:0
  };

  function randChoice(arr){return arr[Math.floor(Math.random()*arr.length)];}

  function genMap(seed=false){
    const tiles = [];
    for(let y=0;y<SIZE;y++){
      const row = [];
      for(let x=0;x<SIZE;x++){
        // 默认随机选择生物群系，靠近中心偏向平原，靠近边缘更可能是海洋
        let t = randChoice(types);
        const d = Math.abs(x-SIZE/2)+Math.abs(y-SIZE/2);
        if(d<=2 && Math.random()<0.75) t = 'plains';
        if((x===0||y===0||x===SIZE-1||y===SIZE-1) && Math.random()<0.6) t = 'ocean';
        // 小概率生成山脉集中区
        if(Math.random()<0.08) t = 'mountain';
        if(x===state.player.x && y===state.player.y) t='player';
        row.push({type:t,items:generateItemsFor(t)});
      }
      tiles.push(row);
    }
    return tiles;
  }

  function generateItemsFor(type){
    switch(type){
      case 'forest': return {'木材': Math.random()<0.8?1+Math.floor(Math.random()*3):0};
      case 'plains': return {'草': Math.random()<0.7?1+Math.floor(Math.random()*2):0};
      case 'desert': return {'沙': Math.random()<0.8?1+Math.floor(Math.random()*3):0};
      case 'taiga': return {'木材': Math.random()<0.6?1+Math.floor(Math.random()*2):0,'皮革': Math.random()<0.2?1:0};
      case 'swamp': return {'泥': Math.random()<0.6?1+Math.floor(Math.random()*2):0,'药草': Math.random()<0.3?1:0};
      case 'snow': return {'冰': Math.random()<0.5?1:0};
      case 'mountain': return {'矿石': Math.random()<0.7?1+Math.floor(Math.random()*3):0};
      case 'beach': return {'沙': Math.random()<0.9?1+Math.floor(Math.random()*2):0};
      case 'ocean': return {'鱼': Math.random()<0.6?1+Math.floor(Math.random()*3):0};
      default: return {};
    }
  }

  function render(){
    mapEl.innerHTML='';
    for(let y=0;y<SIZE;y++){
      for(let x=0;x<SIZE;x++){
        const c = document.createElement('div');
        c.className='cell';
        let t = state.tiles[y][x].type;
        if(state.player.x===x && state.player.y===y) t='player';
        c.classList.add(t);
        c.textContent = tileLabel(t,state.tiles[y][x]);
        c.addEventListener('click',()=>{ log('点击格子 '+x+','+y+' 类型:'+t); });
        mapEl.appendChild(c);
      }
    }
    document.getElementById('hp').textContent=state.hp;
    document.getElementById('hung').textContent=state.hunger;
    document.getElementById('water').textContent=state.water;
    document.getElementById('lv').textContent=state.lv;
    document.getElementById('load').textContent=state.load;
    renderResources();
  }

  function tileLabel(tileType,tile){
  if(tileType==='player') return '我';
  const map={
    forest:'森林', plains:'平原', desert:'沙漠', taiga:'针叶', swamp:'沼泽', snow:'雪地', mountain:'山地', beach:'沙滩', ocean:'海洋'
  };
  return map[tileType]||'';
}

  function move(dx,dy){
    const nx = state.player.x+dx, ny = state.player.y+dy;
    if(nx<0||nx>=SIZE||ny<0||ny>=SIZE) { log('不能移动出地图。'); return; }
    const dest = state.tiles[ny][nx].type;
    if(dest==='wall') { log('这里无法通过。'); return; }
    state.player.x=nx; state.player.y=ny;
    state.time += 1; tickAfterMove(); render();
    log('移动到 '+nx+','+ny+' ('+dest+')');
  }

  function tickAfterMove(){
    state.hunger = Math.max(0,state.hunger-2);
    state.water = Math.max(0,state.water-1);
    if(state.hunger===0||state.water===0) state.hp = Math.max(0,state.hp-5);
    // 自动拾取少量
    const tile = state.tiles[state.player.y][state.player.x];
    for(const k in tile.items){
      if(tile.items[k]>0){
        const take = Math.min(tile.items[k],1);
        addToInv(k,take);
        tile.items[k]-=take;
        log('自动拾取: '+k+' x'+take);
      }
    }
  }

  function explore(){
    const tile = state.tiles[state.player.y][state.player.x];
    if(Math.random()<0.2){
      log('你发现了一个小补给箱: 食物x2'); addToInv('食物',2); return;
    }
    if(Math.random()<0.15){
      log('遭遇小怪！ 战斗中受伤 -5HP'); state.hp=Math.max(0,state.hp-5); return;
    }
    log('没有发现特殊事件。');
  }

  function gather(){
    const tile = state.tiles[state.player.y][state.player.x];
    let found=false;
    for(const k in tile.items){
      if(tile.items[k]>0){
        const amount = tile.items[k];
        addToInv(k,amount);
        log('采集到: '+k+' x'+amount);
        tile.items[k]=0; found=true; state.time+=1; break;
      }
    }
    if(!found) log('这里没有可采集的资源。');
    render();
  }

  function addToInv(name,qty){
    state.inventory[name] = (state.inventory[name]||0)+qty;
    state.load += qty; if(state.load>20) log('负重过高，行动会受限。');
    renderResources();
  }

  function renderResources(){
    resourcesEl.innerHTML='';
    for(const k in state.inventory){
      const d = document.createElement('div'); d.className='resource'; d.textContent=k+': '+state.inventory[k];
      resourcesEl.appendChild(d);
    }
  }

  function save(){ localStorage.setItem('island_save',JSON.stringify(state)); log('已保存到本地。'); }
  function load(){ const s=localStorage.getItem('island_save'); if(!s){log('没有存档');return;} state=JSON.parse(s); log('读取本地存档。'); render(); }

  function log(s){ const p=document.createElement('div'); p.textContent=(new Date().toLocaleTimeString())+' '+s; logEl.prepend(p); }

  // 绑定按钮
  document.getElementById('up').addEventListener('click',()=>move(0,-1));
  document.getElementById('down').addEventListener('click',()=>move(0,1));
  document.getElementById('left').addEventListener('click',()=>move(-1,0));
  document.getElementById('right').addEventListener('click',()=>move(1,0));
  document.getElementById('explore').addEventListener('click',explore);
  document.getElementById('gather').addEventListener('click',gather);
  document.getElementById('save').addEventListener('click',save);
  document.getElementById('load').addEventListener('click',load);

  // 键盘移动
  window.addEventListener('keydown',e=>{
    if(['ArrowUp','w'].includes(e.key)) move(0,-1);
    if(['ArrowDown','s'].includes(e.key)) move(0,1);
    if(['ArrowLeft','a'].includes(e.key)) move(-1,0);
    if(['ArrowRight','d'].includes(e.key)) move(1,0);
  });

  // 初始化
  state.tiles = genMap();
  render();
  log('游戏已准备。欢迎来到孤岛。');

</script>  <!-- TODO: Add Minecraft-like biome diversity and biome info panel here --><div id="battle" style="display:none;position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;">
  <div style="background:#fff;padding:20px;border-radius:10px;min-width:220px;text-align:center">
    <div style="font-weight:700;margin-bottom:10px">战斗中</div>
    <div>你 HP: <span id="bhp">100</span></div>
    <div>敌人 HP: <span id="ehp">20</span></div>
    <button id="batk">攻击</button>
    <button id="brun">逃跑</button>
  </div>
</div>
<script>
let battleEnemy=null;
function startBattle(name){ battleEnemy={name, hp:20}; document.getElementById('bhp').textContent=state.hp; document.getElementById('ehp').textContent=battleEnemy.hp; document.getElementById('battle').style.display='flex'; log('遭遇 '+name+'!'); }
document.getElementById('batk').onclick=()=>{ const dmg=5+Math.floor(Math.random()*5); battleEnemy.hp=Math.max(0,battleEnemy.hp-dmg); document.getElementById('ehp').textContent=battleEnemy.hp; log('你对 '+battleEnemy.name+' 造成 '+dmg+' 伤害'); if(battleEnemy.hp<=0){ log('你击败了 '+battleEnemy.name+'!'); document.getElementById('battle').style.display='none'; return;} const edmg=3+Math.floor(Math.random()*4); state.hp=Math.max(0,state.hp-edmg); document.getElementById('bhp').textContent=state.hp; document.getElementById('hp').textContent=state.hp; log(battleEnemy.name+' 攻击你造成 '+edmg+' 伤害'); if(state.hp<=0){ log('你死亡了...'); document.getElementById('battle').style.display='none'; }}
document.getElementById('brun').onclick=()=>{ if(Math.random()<0.5){ log('逃跑成功'); document.getElementById('battle').style.display='none'; } else { log('逃跑失败！'); const edmg=3+Math.floor(Math.random()*4); state.hp=Math.max(0,state.hp-edmg); document.getElementById('bhp').textContent=state.hp; document.getElementById('hp').textContent=state.hp; }}
</script>
</body>
</html>