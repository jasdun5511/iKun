<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>肉鸽扑克牌 - 地形与生态系统</title>
  <style>
    body { font-family: sans-serif; margin: 0; background: #1b1b1b; color: #fff; }
    h1 { text-align: center; padding: 20px; }
    #biome-list { display: flex; flex-wrap: wrap; padding: 10px; gap: 10px; justify-content: center; }
    .biome-btn {
      padding: 15px 20px;
      background: #333;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.2s;
      border: 1px solid #555;
    }
    .biome-btn:hover { background: #444; }
    #info-panel {
      margin: 20px auto;
      padding: 20px;
      width: min(600px, 90%);
      background: #222;
      border-radius: 12px;
      border: 1px solid #555;
    }
    .section { margin-top: 10px; }
    .label { color: #7ddcff; }
  </style>
</head>
<body>
  <h1>地形生态系统地形信息面板</h1>

  <div id="biome-list"></div>

  <div id="info-panel">
    <h2 id="biome-name">请选择一个地形</h2>
    <div class="section"><span class="label">友好生物：</span><span id="friendly"></span></div>
    <div class="section"><span class="label">敌对生物：</span><span id="hostile"></span>（点击敌对生物进入战斗）</div>
    <div class="section"><span class="label">矿物自然资源：</span><span id="resources"></span></div>
  </div>

<script>
const biomes = {
  "森林": {
    friendly: ["鹿", "兔子", "蜂群"],
    hostile: ["狼", "巨型蜘蛛"],
    resources: ["木材", "蘑菇", "树脂"]
  },
  "沙漠": {
    friendly: ["沙狐", "仙人掌精灵"],
    hostile: ["沙虫", "盗匪"],
    resources: ["沙子", "仙人掌", "化石碎片"]
  },
  "雪原": {
    friendly: ["雪兔", "驯鹿"],
    hostile: ["雪怪", "冰狼"],
    resources: ["冰晶矿", "冷杉木"]
  },
  "沼泽": {
    friendly: ["小蜥蜴", "萤火虫群"],
    hostile: ["腐沼怪", "毒蛇"],
    resources: ["湿地泥", "药草", "苔藓矿"]
  },
  "山地": {
    friendly: ["山羊", "鹰"],
    hostile: ["巨岩人", "山贼"],
    resources: ["铁矿", "银矿", "花岗岩"]
  },
  "平原": {
    friendly: ["牛", "羊", "野马"],
    hostile: ["野狗", "夜行者"],
    resources: ["草药", "土壤矿", "陶土"]
  }
};

const biomeList = document.getElementById("biome-list");

Object.keys(biomes).forEach(name => {
  const btn = document.createElement("div");
  btn.className = "biome-btn";
  btn.textContent = name;
  btn.onclick = () => loadBiome(name);
  // 点击地形后自动进入第一个敌对生物的战斗
  const hostile = biomes[name].hostile;
  if (hostile && hostile.length > 0) startBattle(hostile[0]);
  biomeList.appendChild(btn);
});

function loadBiome(name) {
  const b = biomes[name];
  document.getElementById("biome-name").textContent = name;
  document.getElementById("friendly").textContent = b.friendly.join("、");
  
  const hostileSpan = document.getElementById("hostile");
  hostileSpan.innerHTML = "";
  b.hostile.forEach(enemy => {
    const e = document.createElement('span');
    e.textContent = enemy + ' ';
    e.style.cursor = 'pointer';
    e.style.textDecoration = 'underline';
    e.onclick = () => startBattle(enemy);
    hostileSpan.appendChild(e);
  });

  document.getElementById("resources").textContent = b.resources.join("、");
}(name) {
  const b = biomes[name];
  document.getElementById("biome-name").textContent = name;
  document.getElementById("friendly").textContent = b.friendly.join("、");
  document.getElementById("hostile").textContent = b.hostile.join("、");
  document.getElementById("resources").textContent = b.resources.join("、");
}
</script>

  <!-- Battle System -->
  <div id="battle-panel" style="display:none; margin:20px auto; width:min(600px,90%); background:#300; padding:20px; border-radius:12px; border:1px solid #a33;">
    <h2>⚔ 战斗中</h2>
    <div class="section"><span class="label">你的生命：</span><span id="player-hp"></span></div>
    <div class="section"><span class="label">敌人生命：</span><span id="enemy-hp"></span></div>
    <div class="section"><span class="label">逃跑概率：</span><span id="escape-rate"></span></div>
    <br>
    <button onclick="attack()">攻击</button>
    <button onclick="tryEscape()">逃跑</button>
  </div>

<script>
let playerHP = 100;
let enemyHP = 0;
let escapeRate = 0;

function startBattle(enemyName) {
  document.getElementById('battle-panel').style.display = 'block';
  playerHP = 100;
  enemyHP = Math.floor(Math.random() * 60) + 40;
  escapeRate = Math.floor(Math.random() * 40) + 30;
  updateBattleUI();
}

function updateBattleUI() {
  document.getElementById('player-hp').textContent = playerHP;
  document.getElementById('enemy-hp').textContent = enemyHP;
  document.getElementById('escape-rate').textContent = escapeRate + '%';
}

function attack() {
  const dmg = Math.floor(Math.random() * 20) + 5;
  enemyHP -= dmg;
  if (enemyHP <= 0) {
    enemyHP = 0;
    updateBattleUI();
    alert('你击败了敌人！');
    document.getElementById('battle-panel').style.display = 'none';
    return;
  }
  const enemyDmg = Math.floor(Math.random() * 15) + 5;
  playerHP -= enemyDmg;
  if (playerHP <= 0) {
    playerHP = 0;
    updateBattleUI();
    alert('你被击败了！');
    document.getElementById('battle-panel').style.display = 'none';
    return;
  }
  updateBattleUI();
}

function tryEscape() {
  const roll = Math.random() * 100;
  if (roll <= escapeRate) {
    alert('逃跑成功！');
    document.getElementById('battle-panel').style.display = 'none';
  } else {
    const enemyDmg = Math.floor(Math.random() * 15) + 5;
    playerHP -= enemyDmg;
    if (playerHP <= 0) {
      playerHP = 0;
      alert('逃跑失败并被击败！');
      document.getElementById('battle-panel').style.display = 'none';
      return;
    }
    alert('逃跑失败，受到攻击！');
  }
  updateBattleUI();
}
</script>

</body>
</html>
